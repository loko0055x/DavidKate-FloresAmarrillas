<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>ðŸŒ» Girasol Creciendo</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: black;
      }
      #espacio {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 0;
      }
      canvas.threejs {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <!-- Fondo -->
    <canvas id="espacio"></canvas>
    <!-- Girasol -->
    <canvas class="threejs"></canvas>

    <script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script>
      // ===== FONDO ESTRELLADO =====
      const canvas = document.getElementById("espacio");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const estrellas = Array.from({ length: 100 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2,
        speed: Math.random() * 2 + 1,
      }));

      function animarEspacio() {
        ctx.fillStyle = "rgba(0,0,0,0.3)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        estrellas.forEach((e) => {
          ctx.beginPath();
          ctx.arc(e.x, e.y, e.size, 0, Math.PI * 2);
          ctx.fill();
          e.x -= e.speed;
          e.y += e.speed * 0.5;
          if (e.x < 0 || e.y > canvas.height) {
            e.x = Math.random() * canvas.width;
            e.y = -10;
          }
        });
        requestAnimationFrame(animarEspacio);
      }
      animarEspacio();

      // ===== ESCENA 3D =====
      const threeCanvas = document.querySelector(".threejs");
      const renderer = new THREE.WebGLRenderer({
        canvas: threeCanvas,
        alpha: true,
        antialias: true,
      });
      renderer.setSize(window.innerWidth, window.innerHeight);

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        45,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 6;

      // Luces
      const pointLight = new THREE.PointLight(0xffffff, 2, 100);
      pointLight.position.set(5, 5, 5);
      scene.add(pointLight);
      scene.add(new THREE.AmbientLight(0xffffff, 0.6));

      // ===== CREAR GIRASOL =====
      function crearGirasol() {
        const grupo = new THREE.Group();

        // Centro
        const centroGeo = new THREE.SphereGeometry(0.5, 32, 32);
        const centroMat = new THREE.MeshStandardMaterial({ color: 0x654321 });
        const centro = new THREE.Mesh(centroGeo, centroMat);
        centro.scale.set(0, 0, 0); // empieza oculto
        grupo.add(centro);

        // PÃ©talos
        const petaloGeo = new THREE.ConeGeometry(0.15, 1, 16);
        const petaloMat = new THREE.MeshStandardMaterial({ color: 0xffd700 });
        const petalos = [];

        for (let i = 0; i < 30; i++) {
          const petalo = new THREE.Mesh(petaloGeo, petaloMat);
          const angulo = (i / 30) * Math.PI * 2;
          petalo.position.set(Math.cos(angulo) * 1, Math.sin(angulo) * 1, 0);
          petalo.lookAt(0, 0, 0);
          petalo.rotation.z += Math.PI;
          petalo.scale.set(0, 0, 0); // oculto al inicio
          grupo.add(petalo);
          petalos.push(petalo);
        }

        scene.add(grupo);

        // Animaciones
        gsap.to(centro.scale, {
          x: 1,
          y: 1,
          z: 1,
          duration: 1,
          ease: "back.out(2)",
        });
        gsap.to(
          petalos.map((p) => p.scale),
          {
            x: 1,
            y: 1,
            z: 1,
            duration: 1,
            ease: "back.out(2)",
            stagger: 0.1,
            delay: 0.5,
          }
        );

        return grupo;
      }

      const girasol = crearGirasol();

      // ===== ANIMAR =====
      function animate() {
        requestAnimationFrame(animate);
        girasol.rotation.y += 0.005; // giro lento
        girasol.rotation.x = Math.sin(Date.now() * 0.001) * 0.05; // efecto "respirar"
        renderer.render(scene, camera);
      }
      animate();

      // ===== RESPONSIVE =====
      window.addEventListener("resize", () => {
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });
    </script>
  </body>
</html>
